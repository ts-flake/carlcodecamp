## é¢˜ç›®
[18.å››æ•°ä¹‹å’Œ | åŠ›æ‰£é¢˜ç›®](https://leetcode.cn/problems/4sum/description/)

å’Œ [[03-å“ˆå¸Œè¡¨-ä¸‰æ•°ä¹‹å’Œ]] ç±»ä¼¼, ä»ç»™å®šçš„æ•´æ•°æ•°ç»„é‡Œè¿”å›æ‰€æœ‰*ä¸é‡å¤*çš„å’Œæ•°ä¸º `target` çš„å››å…ƒç»„.

## åˆæ­¥è§£ç­”
æœ¬é¢˜è¿˜æ˜¯ç”¨åŒæŒ‡é’ˆæ³•, è¿˜æ˜¯ä¸å¤ªç†Ÿ, å°±ä»¿ç…§[[03-å“ˆå¸Œè¡¨-ä¸‰æ•°ä¹‹å’Œ]]æ¥å†™ä¸€å†™. ä»å¤–åˆ°é‡Œæœ‰ä¸¤ä¸ª for ä¸€ä¸ª while, æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^3), ç©ºé—´å¤æ‚åº¦ O(1).
```python
class Solution:
    def fourSum(self, nums: List[int], target: int) -> List[List[int]]:
        nums.sort()
        res = []
        # a=nums[i], b=nums[j], c=nums[left], d=nums[right]
        # i < j < left < right
        for i in range(len(nums)):
            # è·³è¿‡ç›¸åŒçš„ a
            if i > 0 and nums[i] == nums[i-1]:
                continue
            for j in range(i+1, len(nums)):
                # è·³è¿‡ç›¸åŒçš„ b
                if j > i+1 and nums[j] == nums[j-1]:
                    continue
                left = j+1
                right = len(nums)-1
                while right > left:
                    sum_ = nums[i] + nums[j] + nums[left] + nums[right]
                    if sum_ < target:
                        left += 1
                    elif sum_ > target:
                        right -= 1
                    else:
                        res.append([nums[i], nums[j], nums[left], nums[right]])

                        while right>left and nums[right] == nums[right-1]:
                            right -= 1
                        while right>left and nums[left] == nums[left+1]:
                            left += 1
                        right -= 1
                        left += 1
        return res
```

## å‚è€ƒè§£ç­”
å‚è€ƒè§£ç­”å¤šäº†ä¸€ç‚¹å‰ªæçš„æ“ä½œ, å¯ä»¥æå‰ç»“æŸç¨‹åº, ä½†å¤æ‚åº¦çš„è®¡ç®—æ˜¯ä¸å—å½±å“ (è€ƒè™‘çš„äº‹ worst case), è¿˜æ˜¯ O(n^3) æ—¶é—´å¤æ‚åº¦.
```python
class Solution:
    def fourSum(self, nums: List[int], target: int) -> List[List[int]]:
        nums.sort()
        n = len(nums)
        result = []
        for i in range(n):
            if nums[i] > target and nums[i] > 0 and target > 0:# å‰ªæï¼ˆå¯çœï¼‰
                break
            if i > 0 and nums[i] == nums[i-1]:# å»é‡
                continue
            for j in range(i+1, n):
                if nums[i] + nums[j] > target and target > 0: #å‰ªæï¼ˆå¯çœï¼‰
                    break
                if j > i+1 and nums[j] == nums[j-1]: # å»é‡
                    continue
                left, right = j+1, n-1
                while left < right:
                    s = nums[i] + nums[j] + nums[left] + nums[right]
                    if s == target:
                        result.append([nums[i], nums[j], nums[left], nums[right]])
                        while left < right and nums[left] == nums[left+1]:
                            left += 1
                        while left < right and nums[right] == nums[right-1]:
                            right -= 1
                        left += 1
                        right -= 1
                    elif s < target:
                        left += 1
                    else:
                        right -= 1
        return result
```

å†çœ‹ä¸ªå­—å…¸ç‰ˆæœ¬çš„, è¿™é‡Œç”¨ä¸€ä¸ª dict æ¥è®°å½•æ•°ç»„é‡Œçš„æ•°å‡ºç°çš„æ¬¡æ•°, ç„¶åä¸‰ä¸ª for å¾ªç¯éå†æ‰€æœ‰ç»„åˆ, æœ€ç»ˆå°†ç­”æ¡ˆç”¨ä¸€ä¸ª set æ¥ç»´æŠ¤, ç¡®ä¿æ²¡æœ‰é‡å¤å…ƒç»„. æ—¶é—´å¤æ‚åº¦ O(n^3), ç©ºé—´å¤æ‚åº¦ O(1).

ğŸš¨æ³¨æ„åˆ° for å¾ªç¯ä¸æ˜¯ä»å¤´å¼€å§‹çš„, å› ä¸ºåœ¨è¿™é‡Œå…ƒç»„å…ƒç´ çš„é¡ºåºä¸é‡è¦. è¿˜æœ‰ç¡®ä¿ set èƒ½æ­£å¸¸å‘æŒ¥ä½œç”¨, åŠ å…¥å…ƒç»„æ—¶è¦æ’ä¸ªåº.
```python
class Solution(object):
    def fourSum(self, nums, target):
        """
        :type nums: List[int]
        :type target: int
        :rtype: List[List[int]]
        """
        # åˆ›å»ºä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨è¾“å…¥åˆ—è¡¨ä¸­æ¯ä¸ªæ•°å­—çš„é¢‘ç‡
        freq = {}
        for num in nums:
            freq[num] = freq.get(num, 0) + 1
        
        # åˆ›å»ºä¸€ä¸ªé›†åˆæ¥å­˜å‚¨æœ€ç»ˆç­”æ¡ˆï¼Œå¹¶éå†4ä¸ªæ•°å­—çš„æ‰€æœ‰å”¯ä¸€ç»„åˆ
        ans = set()
        for i in range(len(nums)):
            for j in range(i + 1, len(nums)):
                for k in range(j + 1, len(nums)):
                    val = target - (nums[i] + nums[j] + nums[k])
                    if val in freq:
                        # ç¡®ä¿æ²¡æœ‰é‡å¤
                        count = (nums[i] == val) + (nums[j] == val) + (nums[k] == val)
                        if freq[val] > count:
                            ans.add(tuple(sorted([nums[i], nums[j], nums[k], val])))
        
        return [list(x) for x in ans]
```

## å¿ƒå¾—
å­—å…¸æ³•æœ¬è´¨æ˜¯é€šè¿‡ dict çš„å¿«é€ŸæŸ¥è¯¢å’Œ set å»é‡æ¥å®ç°çš„. åœ¨åŒæŒ‡é’ˆæ³•é‡Œ, éœ€è¦ `nums.sort()` æ˜¯å› ä¸ºæŒ‡é’ˆçš„ç§»åŠ¨æ˜¯å»ºç«‹åœ¨åºåˆ—å•è°ƒæ€§çš„å‡è®¾ä¸Šçš„.

æœ¬é¢˜æ¯” [[03-å“ˆå¸Œè¡¨-å››æ•°ç›¸åŠ II]] éš¾äº†ä¸å°‘, åŸå› åœ¨äºå»é‡çš„æ“ä½œ. è¿™ä¸€ç‚¹é€šè¿‡è§‚å¯Ÿå‚è€ƒè§£ç­”é‡Œçš„å­—å…¸æ³•ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥,åœ¨ [[03-å“ˆå¸Œè¡¨-å››æ•°ç›¸åŠ II]] é‡Œåªæœ‰ä¸¤å±‚ for, å¤æ‚åº¦æ˜¯ O(n^2), å› ä¸ºæ— é¡»æ‹…å¿ƒé‡å¤.