---
status: âœ…å®Œæˆ
start: 2025-06-21
due: 2025-06-21
topic:
  - ç®—æ³•
  - ä»£ç éšæƒ³å½•
tags:
  - project/ä»£ç éšæƒ³å½•ç®—æ³•è¥
  - è®¡ç®—æœº/ç®—æ³•
recommend: 3
priority: 1
authors:
  - Donghan
dg-publish: false
---
## é¢˜ç›®
[109.å†—ä½™çš„è¾¹II | å¡ç é¢˜ç›®](https://kamacoder.com/problempage.php?pid=1182)

æœ‰ä¸€ç§æœ‰å‘æ ‘,è¯¥æ ‘åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹, æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹éƒ½æ˜¯è¯¥æ ¹èŠ‚ç‚¹çš„åç»§. è¯¥æ ‘é™¤äº†æ ¹èŠ‚ç‚¹ä¹‹å¤–çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸”åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹, è€Œæ ¹èŠ‚ç‚¹æ²¡æœ‰çˆ¶èŠ‚ç‚¹. æœ‰å‘æ ‘æ‹¥æœ‰ n ä¸ªèŠ‚ç‚¹å’Œ n - 1 æ¡è¾¹. å¦‚å›¾:
![[graph_union_find5.png|200]]
ç°åœ¨æœ‰ä¸€ä¸ªæœ‰å‘å›¾, æœ‰å‘å›¾æ˜¯åœ¨æœ‰å‘æ ‘ä¸­çš„ä¸¤ä¸ªæ²¡æœ‰ç›´æ¥é“¾æ¥çš„èŠ‚ç‚¹ä¸­é—´æ·»åŠ ä¸€æ¡æœ‰å‘è¾¹. å¦‚å›¾:
![[graph_union_find6.png|200]]
è¾“å…¥ä¸€ä¸ªæœ‰å‘å›¾, è¯¥å›¾ç”±ä¸€ä¸ªæœ‰ç€ n ä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹ç¼–å· ä» 1 åˆ° n), n æ¡è¾¹, è¯·è¿”å›ä¸€æ¡å¯ä»¥åˆ é™¤çš„è¾¹, ä½¿å¾—åˆ é™¤è¯¥æ¡è¾¹ä¹‹åè¯¥æœ‰å‘å›¾å¯ä»¥è¢«å½“ä½œä¸€æ£µæœ‰å‘æ ‘.

## åˆæ­¥è§£ç­”
çœ‹è§£ç­”.
## å‚è€ƒè§£ç­”
ä¸åŒäº [[11-å›¾è®º-å†—ä½™è¿æ¥]], æœ¬é¢˜æ˜¯**æœ‰å‘æ ‘/å›¾**. ä¸ºäº†ä½¿å¾—åˆ é™¤ä¸€æ¡è¾¹åå¾—åˆ°çš„è¿˜æ˜¯ä¸€æ£µæœ‰å‘æ ‘, æ£€æµ‹åˆ°å›ç¯å, è¾¹ä¸èƒ½ä¹±åˆ .

âœ…åˆ†æƒ…å†µè®¨è®º (ğŸš¨æ³¨æ„é¢˜ç›®æ˜¯åœ¨ä¸€æ£µæœ‰å‘æ ‘ä¸ŠåŠ ä¸€æ¡è¾¹å¾—åˆ°æœ‰ç¯å›¾):
- æƒ…å†µä¸€: å…¥åº¦ 2 å‡ºåº¦ 0/M (è¾¹åŠ åœ¨äº†å¶å­/éæ ¹èŠ‚ç‚¹, åŸå…¥åº¦ 1 å‡ºåº¦ 0/M), **åˆ é™¤ä»»æ„ä¸€æ¡å…¥åº¦è¾¹**
- æƒ…å†µäºŒ: å…¥åº¦ 2 å‡ºåº¦ M (è¾¹åŠ åœ¨äº†éå¶å­éæ ¹èŠ‚ç‚¹, åŸå…¥åº¦ 1 å‡ºåº¦ M), åªèƒ½**åˆ é™¤ç‰¹å®šçš„ä¸€æ¡å…¥åº¦è¾¹**
- æƒ…å†µä¸‰: å…¥åº¦ 1 å‡ºåº¦ M ( è¾¹åŠ åœ¨äº†æ ¹èŠ‚ç‚¹, åŸå…¥åº¦ 0 å‡ºåº¦ M), **åˆ é™¤ç¯å†…çš„å…¥åº¦/å‡ºåº¦è¾¹**

![[graph_union_find7.png|200]] ![[graph_union_find8.png|200]] ![[graph_union_find9.png|200]]

```python
from collections import defaultdict

father = list()


def find(u):
    if u == father[u]:
        return u
    else:
        father[u] = find(father[u])
        return father[u]
        
        
def is_same(u, v):
    u = find(u)
    v = find(v)
    return u == v
    
    
def join(u, v):
    u = find(u)
    v = find(v)
    if u != v:
        father[u] = v
    
    
def is_tree_after_remove_edge(edges, edge, n):
    # åˆå§‹åŒ–å¹¶æŸ¥é›†
    global father 
    father = [i for i in range(n + 1)]
    
    for i in range(len(edges)):
        if i == edge:
            continue
        s, t = edges[i]
        if is_same(s, t): # æˆç’°ï¼Œå³ä¸æ˜¯æœ‰å‘æ¨¹
            return False
        else: # å°‡s,tæ”¾å…¥é›†åˆä¸­
            join(s, t)
    return True
    

def get_remove_edge(edges):
    # åˆå§‹åŒ–å¹¶æŸ¥é›†
    global father
    father = [i for i in range(n + 1)]
    
    for s, t in edges:
        if is_same(s, t):
            print(s, t)
            return
        else:
            join(s, t)
        

if __name__ == "__main__":
    # è¼¸å…¥
    n = int(input())
    edges = list()
    in_degree = defaultdict(int)
    
    for i in range(n):
        s, t = map(int, input().split())
        in_degree[t] += 1
        edges.append([s, t])
        
    # å°‹æ‰¾å…¥åº¦ç‚º2çš„é‚Šï¼Œä¸¦ç´€éŒ„å…¶ä¸‹æ¨™(index)
    vec = list()
    for i in range(n - 1, -1, -1):
        if in_degree[edges[i][1]] == 2:
            vec.append(i)
            
    # è¼¸å‡º
    if len(vec) > 0:
        # æƒ…æ³ä¸€ï¼šåˆªé™¤è¼¸å‡ºé †åºé å¾Œçš„é‚Š 
        if is_tree_after_remove_edge(edges, vec[0], n):
            print(edges[vec[0]][0], edges[vec[0]][1])
        # æƒ…æ³äºŒï¼šåªèƒ½åˆªé™¤ç‰¹å®šçš„é‚Š
        else:
            print(edges[vec[1]][0], edges[vec[1]][1])
    else:
        # æƒ…æ³ä¸‰ï¼šåŸåœ–æœ‰ç’°, å°±æ˜¯å†—ä½™è¿æ¥çš„ä»£ç 
        get_remove_edge(edges)
```

## å¿ƒå¾—

---
## links


## reference
